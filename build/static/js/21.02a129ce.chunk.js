(this["webpackJsonpvuexy-react-admin-dashboard"]=this["webpackJsonpvuexy-react-admin-dashboard"]||[]).push([[21],{452:function(e,s,a){"use strict";a.d(s,"b",(function(){return n})),a.d(s,"c",(function(){return c})),a.d(s,"a",(function(){return i}));var t=a(460),r=a.n(t),n=function(e){var s=r.a.stringify(e);return s?"?".concat(s):""};function c(e,s,a){var t=new Image;t.crossOrigin="Anonymous",t.onload=function(){var e,t=document.createElement("CANVAS"),r=t.getContext("2d");t.height=this.naturalHeight,t.width=this.naturalWidth,r.drawImage(this,0,0),e=t.toDataURL(a),s(e)},t.src=e,(t.complete||void 0===t.complete)&&(t.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",t.src=e)}function i(e){return new Promise((function(s,a){var t=new FileReader;t.readAsDataURL(e),t.onload=function(){return s(t.result)},t.onerror=a}))}},453:function(e,s,a){"use strict";var t=a(78),r=a.n(t),n="https://cdn.kiemdinhoto.vn/",c=a(116),i=a(452);s.a={send:function(e){var s=e.method,a=void 0===s?"get":s,t=e.path,d=e.data,o=void 0===d?null:d,m=e.query,l=void 0===m?null:m,j=e.headers,u=void 0===j?{}:j,h=e.newUrl;return new Promise((function(e){var s=n+"".concat(t).concat(Object(i.b)(l));h&&(s="".concat(h).concat(Object(i.b)(l)));var d=window.localStorage.getItem("accessToken");if(d){var m=d.replace(/"/g,"");u.Authorization="Bearer ".concat(m)}r()({method:a,url:s,data:o,headers:u}).then((function(s){var a=s.data;return e(a)})).catch((function(s){var a=s.response,t=void 0===a?{}:a,r=t.data?t.data:null;if(r){var n=r.statusCode,i=r.message;if(505===n)c.c.warn("Unauthorized");else if(413===n&&"Payload content length greater than maximum allowed: 1048576"===i)c.c.warn("Image too large");else if(401===n&&"Expired token received for JSON Web Token validation"===i)window.localStorage.clear(),window.location.href="/";else{if(!(401===n&&"Unauthorized"===i||403===n&&"InvalidToken"===i))return e(r.data);window.localStorage.clear(),window.location.href="/"}}else c.c.warn("Error from server")}))}))}}},458:function(e,s,a){},472:function(e,s,a){"use strict";a.d(s,"a",(function(){return r}));a(0),a(473);var t=a(6);function r(e){var s=e.onChange,a=e.checked,r=e.disabled;return Object(t.jsxs)("label",{className:"switch",children:[Object(t.jsx)("input",{type:"checkbox",checked:a,onChange:s,disabled:r}),Object(t.jsx)("span",{className:"slider round"})]})}},473:function(e,s,a){},503:function(e,s,a){},504:function(e,s,a){},964:function(e,s,a){"use strict";a.r(s);var t=a(30),r=a(1),n=a(16),c=a(0),i=a(116),d=(a(465),a(503),a(466)),o=(a(458),a(453)),m=(a(514),a(515),a(504),a(948)),l=a(961),j=a(541),u=a(663),h=a(664),b=a(540),f=a(930),O=a(447),v=a(602),S=a(599),g=a(600),x=a(965),p=a(457),C=a(126),M=a(472),w=a(637),P=a(6),U=function(e){var s=e.intl,a=Object(p.h)().state,C=Object(c.useState)({}),U=Object(n.a)(C,2),I=U[0],y=U[1],A=Object(c.useState)(0),B=Object(n.a)(A,2),N=B[0],T=B[1],V=Object(c.useState)(0),k=Object(n.a)(V,2),E=k[0],R=k[1],q=Object(c.useState)(!1),F=Object(n.a)(q,2),D=F[0],L=F[1],z=Object(c.useState)(I.smsProvider||""),J=Object(n.a)(z,2),K=J[0],Q=J[1],W=Object(p.g)(),_=Object(d.a)({defaultValues:{}}),G=_.register,H=_.errors,X=_.handleSubmit;Object(c.useEffect)((function(){a&&Object.keys(a).length>0&&(y(a.stationCustomSMSBrandConfig?JSON.parse(a.stationCustomSMSBrandConfig):{}),R(a.stationEnableUseSMS),T(a.stationUseCustomSMSBrand))}),[a]);var Y=function(e,s){y(Object(r.a)(Object(r.a)({},I),{},Object(t.a)({},e,s)))};var Z=function(){switch(I.smsProvider&&K){case"VIETTEL":return Object(P.jsxs)(P.Fragment,{children:[Object(P.jsxs)(m.a,{row:!0,children:[Object(P.jsx)(l.a,{sm:"3",for:"smsCPCode",children:s.formatMessage({id:"smsCPCode"})}),Object(P.jsx)(j.a,{sm:"5",children:Object(P.jsx)(u.a,{name:"smsCPCode",id:"smsCPCode",disabled:1!==N||1!==E,innerRef:G({required:1===N&&1===E}),invalid:H.smsCPCode&&!0,value:I&&I.smsCPCode||"",placeholder:s.formatMessage({id:"smsCPCode"}),onChange:function(e){var s=e.target,a=s.name,t=s.value;Y(a,t)}})}),Object(P.jsx)(j.a,{sm:"4",children:Object(P.jsx)("i",{children:"V\xed d\u1ee5: abc-123"})})]}),Object(P.jsxs)(m.a,{row:!0,children:[Object(P.jsx)(l.a,{sm:"3",for:"smsServiceId",children:s.formatMessage({id:"smsServiceId"})}),Object(P.jsx)(j.a,{sm:"5",children:Object(P.jsx)(u.a,{name:"smsServiceId",id:"smsServiceId",disabled:1!==N||1!==E,innerRef:G({required:1===N&&1===E}),invalid:H.smsServiceId&&!0,value:I&&I.smsServiceId||"",placeholder:s.formatMessage({id:"smsServiceId"}),onChange:function(e){var s=e.target,a=s.name,t=s.value;Y(a,t)}})}),Object(P.jsx)(j.a,{sm:"4",children:Object(P.jsx)("i",{children:"V\xed d\u1ee5: ...abc123"})})]})]});case"VIVAS":return Object(P.jsxs)(m.a,{row:!0,children:[Object(P.jsx)(l.a,{sm:"3",for:"smsBrand",children:s.formatMessage({id:"smsBrand"})}),Object(P.jsx)(j.a,{sm:"5",children:Object(P.jsx)(u.a,{name:"smsBrand",id:"smsBrand",disabled:1!==N||1!==E,innerRef:G({required:1===N&&1===E}),invalid:H.smsBrand&&!0,value:I&&I.smsBrand||"",placeholder:s.formatMessage({id:"smsBrand"}),onChange:function(e){var s=e.target,a=s.name,t=s.value;Y(a,t)}})}),Object(P.jsx)(j.a,{sm:"4",children:Object(P.jsx)("i",{children:"V\xed d\u1ee5: KiemDinhOto"})})]})}};return Object(P.jsxs)(c.Fragment,{children:[Object(P.jsxs)(h.a,{children:[Object(P.jsxs)("div",{className:"pt-1 pl-1 pointer",onClick:W.goBack,children:[Object(P.jsx)(w.a,{}),s.formatMessage({id:"goBack"})]}),Object(P.jsxs)("div",{className:"accountAdmin",children:[Object(P.jsx)("h1",{className:"accountAdmin__title",children:s.formatMessage({id:"info"},{type:"SMS"}).toUpperCase()}),Object(P.jsx)(b.a,{children:Object(P.jsx)(j.a,{sm:"12",md:"8",children:Object(P.jsxs)(f.a,{onSubmit:X((function(e){!function(e){if(1===E&&1===N){if(0===Object.keys(H).length){var t={stationsId:a.stationsId,smsUrl:e.smsUrl,smsUserName:e.smsUserName,smsPassword:e.smsPassword,smsBrand:e.smsBrand,smsCPCode:e.smsCPCode,smsServiceId:e.smsServiceId,smsProvider:K};o.a.send({method:"POST",path:"Stations/updateConfigSMS",data:t,query:null}).then((function(e){e&&(200===e.statusCode?(i.c.success(s.formatMessage({id:"actionSuccess"},{action:s.formatMessage({id:"update"})})),setTimeout((function(){W.push("/pages/station")}),1e3)):i.c.warn(s.formatMessage({id:"actionFailed"},{action:s.formatMessage({id:"update"})})))}))}}else i.c.success(s.formatMessage({id:"actionSuccess"},{action:s.formatMessage({id:"update"})})),setTimeout((function(){W.push("/pages/station")}),1e3)}(Object(r.a)({},e))})),children:[Object(P.jsxs)(m.a,{row:!0,children:[Object(P.jsx)(l.a,{sm:"3",for:"smsUrl",children:"SMS Enable"}),Object(P.jsx)(j.a,{sm:"9",children:Object(P.jsx)(M.a,{checked:1===E,onChange:function(e){var t;t=e.target.checked?1:0,o.a.send({method:"POST",path:"Stations/updateById",data:{id:a.stationsId,data:{stationEnableUseSMS:t}},query:null}).then((function(e){e&&(200===e.statusCode?R(t):i.c.warn(s.formatMessage({id:"actionFailed"},{action:s.formatMessage({id:"update"})})))}))}})})]}),Object(P.jsxs)(m.a,{row:!0,children:[Object(P.jsx)(l.a,{sm:"3",for:"smsProvider",children:s.formatMessage({id:"supplier"},{type:"SMS"})}),Object(P.jsx)(j.a,{sm:"5",children:Object(P.jsxs)(u.a,{className:"w-100",id:"smsProvider",type:"select",invalid:H.smsProvider&&!0,innerRef:G({required:!0}),name:"smsProvider",bsSize:"sm",value:K||I.smsProvider,onChange:function(e){Z();var s=e.target.value;y(I),Q(s)},disabled:1!==E,children:[Object(P.jsx)("option",{value:"",children:s.formatMessage({id:"selectService"})}),Object(P.jsx)("option",{value:"VIETTEL",children:"Viettel"}),Object(P.jsx)("option",{value:"VIVAS",children:"Vivas"})]})}),Object(P.jsx)(j.a,{sm:"4"})]}),Object(P.jsxs)("div",{className:"row",children:[Object(P.jsx)(l.a,{sm:"3",children:s.formatMessage({id:"stationUseCustomSMSBrand"},{type:"SMS Brandname"})}),Object(P.jsx)(j.a,{sm:"9",children:Object(P.jsx)(M.a,{checked:1===N,onChange:function(e){var t;t=e.target.checked?1:0,o.a.send({method:"POST",path:"Stations/updateCustomSMSBrand",data:{stationsId:a.stationsId,stationUseCustomSMSBrand:t},query:null}).then((function(e){e&&(200===e.statusCode?T(t):i.c.warn(s.formatMessage({id:"actionFailed"},{action:s.formatMessage({id:"update"})})))}))},disabled:1!==E})})]}),Object(P.jsxs)(m.a,{row:!0,className:"mt-1",children:[Object(P.jsx)(l.a,{sm:"3",for:"smsUrl",children:"SMS Url"}),Object(P.jsx)(j.a,{sm:"5",children:Object(P.jsx)(u.a,{id:"smsUrl",name:"smsUrl",disabled:1!==N||1!==E,innerRef:G({required:1===N&&1===E}),invalid:H.smsUrl&&!0,placeholder:"SMS Url",value:I&&I.smsUrl||"",onChange:function(e){var s=e.target,a=s.name,t=s.value;Y(a,t)}})}),Object(P.jsx)(j.a,{sm:"4",children:Object(P.jsx)("i",{children:"V\xed d\u1ee5: https://example.vn/SMS"})})]}),Object(P.jsxs)(m.a,{row:!0,children:[Object(P.jsx)(l.a,{sm:"3",for:"smsUserName",children:s.formatMessage({id:"smsUsername"},{type:"SMS"})}),Object(P.jsx)(j.a,{sm:"5",children:Object(P.jsx)(u.a,{id:"smsUserName",name:"smsUserName",disabled:1!==N||1!==E,innerRef:G({required:1===N&&1===E}),invalid:H.smsUserName&&!0,placeholder:s.formatMessage({id:"smsUsername"},{type:"SMS"}),value:I&&I.smsUserName||"",onChange:function(e){var s=e.target,a=s.name,t=s.value;Y(a,t)}})}),Object(P.jsx)(j.a,{sm:"4",children:Object(P.jsx)("i",{children:"V\xed d\u1ee5: example123"})})]}),Object(P.jsxs)(m.a,{row:!0,children:[Object(P.jsx)(l.a,{sm:"3",for:"smsPassword",children:s.formatMessage({id:"smsPassword"},{type:"SMS"})}),Object(P.jsx)(j.a,{sm:"5",children:Object(P.jsx)(u.a,{name:"smsPassword",id:"smsPassword",disabled:1!==N||1!==E,innerRef:G({required:1===N&&1===E}),invalid:H.smsPassword&&!0,value:I&&I.smsPassword||"",placeholder:s.formatMessage({id:"smsPassword"},{type:"SMS"}),onChange:function(e){var s=e.target,a=s.name,t=s.value;Y(a,t)}})}),Object(P.jsx)(j.a,{sm:"4",children:Object(P.jsx)("i",{children:"V\xed d\u1ee5: ...abc123"})})]}),Z(),"VIETTEL"===I.smsProvider&&""===K&&Object(P.jsxs)(P.Fragment,{children:[Object(P.jsxs)(m.a,{row:!0,children:[Object(P.jsx)(l.a,{sm:"3",for:"smsCPCode",children:s.formatMessage({id:"smsCPCode"})}),Object(P.jsx)(j.a,{sm:"5",children:Object(P.jsx)(u.a,{name:"smsCPCode",id:"smsCPCode",disabled:1!==N||1!==E,innerRef:G({required:1===N&&1===E}),invalid:H.smsCPCode&&!0,value:I&&I.smsCPCode||"",placeholder:s.formatMessage({id:"smsCPCode"}),onChange:function(e){var s=e.target,a=s.name,t=s.value;Y(a,t)}})}),Object(P.jsx)(j.a,{sm:"4",children:Object(P.jsx)("i",{children:"V\xed d\u1ee5: abc-123"})})]}),Object(P.jsxs)(m.a,{row:!0,children:[Object(P.jsx)(l.a,{sm:"3",for:"smsServiceId",children:s.formatMessage({id:"smsServiceId"})}),Object(P.jsx)(j.a,{sm:"5",children:Object(P.jsx)(u.a,{name:"smsServiceId",id:"smsServiceId",disabled:1!==N||1!==E,innerRef:G({required:1===N&&1===E}),invalid:H.smsServiceId&&!0,value:I&&I.smsServiceId||"",placeholder:s.formatMessage({id:"smsServiceId"}),onChange:function(e){var s=e.target,a=s.name,t=s.value;Y(a,t)}})}),Object(P.jsx)(j.a,{sm:"4",children:Object(P.jsx)("i",{children:"V\xed d\u1ee5: ...abc123"})})]})]}),"VIVAS"===I.smsProvider&&""===K&&Object(P.jsx)(P.Fragment,{children:Object(P.jsxs)(m.a,{row:!0,children:[Object(P.jsx)(l.a,{sm:"3",for:"smsBrand",children:s.formatMessage({id:"smsBrand"})}),Object(P.jsx)(j.a,{sm:"5",children:Object(P.jsx)(u.a,{name:"smsBrand",id:"smsBrand",disabled:1!==N||1!==E,innerRef:G({required:1===N&&1===E}),invalid:H.smsBrand&&!0,value:I&&I.smsBrand||"",placeholder:s.formatMessage({id:"smsBrand"}),onChange:function(e){var s=e.target,a=s.name,t=s.value;Y(a,t)}})}),Object(P.jsx)(j.a,{sm:"4",children:Object(P.jsx)("i",{children:"V\xed d\u1ee5: KiemDinhOto"})})]})}),Object(P.jsxs)("div",{className:"row m-0 mt-3",children:[Object(P.jsx)(m.a,{className:"p-0 col-12 col-sm-3",children:Object(P.jsx)(O.a.Ripple,{className:"w-100",color:"primary",type:"submit",children:s.formatMessage({id:"submit"})})}),Object(P.jsx)("div",{className:"col-1"}),1===N&&1===E&&Object(P.jsx)(m.a,{className:"col-12 col-sm-3 p-0",children:Object(P.jsx)(O.a.Ripple,{className:"w-100",color:"primary",onClick:function(){return L(!0)},children:"Test SMS"})})]})]})})})]})]}),Object(P.jsx)(v.a,{isOpen:D,toggle:function(){return L(!D)},children:Object(P.jsxs)(f.a,{onSubmit:function(e){e.preventDefault();var a=document.getElementById("testSMS");a.value&&function(e){if("VIETTEL"===K){var a={phoneNumber:e,smsConfig:{smsUrl:I.smsUrl,smsUserName:I.smsUserName,smsPassword:I.smsPassword,smsCPCode:I.smsCPCode,smsServiceId:I.smsServiceId,smsProvider:K}};o.a.send({method:"POST",path:"CustomerMessage/sendTestSMS",data:a}).then((function(e){e&&200===e.statusCode?(i.c.success(s.formatMessage({id:"sent"},{type:""})),L(!1)):i.c.error(s.formatMessage({id:"sendSMSTestFailed"},{type:""}))}))}else{var t={phoneNumber:e,smsConfig:{smsUrl:I.smsUrl,smsUserName:I.smsUserName,smsPassword:I.smsPassword,smsBrand:I.smsBrand,smsProvider:K}};o.a.send({method:"POST",path:"CustomerMessage/sendTestSMS",data:t}).then((function(e){e&&200===e.statusCode?(i.c.success(s.formatMessage({id:"sent"},{type:""})),L(!1)):i.c.error(s.formatMessage({id:"sendSMSTestFailed"},{type:""}))}))}}(a.value)},children:[Object(P.jsx)(S.a,{toggle:function(){return L(!D)},children:s.formatMessage({id:"checkSMS"})}),Object(P.jsxs)(g.a,{children:[Object(P.jsx)("label",{htmlFor:"testSMS",children:s.formatMessage({id:"enterPhoneSendSMS"})}),Object(P.jsx)(m.a,{children:Object(P.jsx)(u.a,{name:"testSMS",id:"testSMS",placeholder:"Nh\u1eadp S\u0110T",type:"SMS",required:!0})})]}),Object(P.jsx)(x.a,{children:Object(P.jsx)(m.a,{children:Object(P.jsx)(O.a,{color:"primary",type:"submit",children:s.formatMessage({id:"send"})})})})]})})]})};s.default=Object(C.c)(Object(c.memo)(U))}}]);
//# sourceMappingURL=21.02a129ce.chunk.js.map